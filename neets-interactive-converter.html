<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEETS Interactive Converter - Sega Genesis Edition</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Sega Genesis 1994 Color Palette */
            --genesis-black: #000000;
            --genesis-blue: #0000ff;
            --genesis-dark-blue: #000088;
            --genesis-sky: #5588ff;
            --genesis-cyan: #00ffff;
            --genesis-green: #00ff00;
            --genesis-yellow: #ffff00;
            --genesis-orange: #ff8800;
            --genesis-red: #ff0000;
            --genesis-pink: #ff00ff;
            --genesis-purple: #8800ff;
            --genesis-white: #ffffff;
            --genesis-gray: #888888;
            --genesis-metal: #4444aa;

            /* UI Colors */
            --ui-bg: #000033;
            --ui-panel: #000066;
            --ui-highlight: #00ffff;
            --ui-shadow: rgba(0, 0, 0, 0.7);
            --ui-glow: rgba(0, 255, 255, 0.5);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--ui-bg) 0%, #001144 100%);
            color: var(--genesis-white);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* CRT Scanline Effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.15) 0px,
                transparent 1px,
                transparent 2px,
                rgba(0, 0, 0, 0.15) 3px
            );
            pointer-events: none;
            z-index: 9999;
        }

        /* Animated Background Stars */
        body::after {
            content: '';
            position: fixed;
            width: 200%;
            height: 200%;
            top: -50%;
            left: -50%;
            background-image:
                radial-gradient(2px 2px at 20% 30%, white, transparent),
                radial-gradient(2px 2px at 60% 70%, white, transparent),
                radial-gradient(1px 1px at 50% 50%, white, transparent),
                radial-gradient(1px 1px at 80% 10%, white, transparent),
                radial-gradient(2px 2px at 90% 60%, white, transparent),
                radial-gradient(1px 1px at 33% 80%, white, transparent);
            background-size: 200% 200%;
            animation: scroll-slow 120s linear infinite;
            opacity: 0.3;
            z-index: -1;
        }

        @keyframes scroll-slow {
            0% { transform: translate(0, 0); }
            100% { transform: translate(-50%, -50%); }
        }

        @keyframes blink {
            0%, 50%, 100% { opacity: 1; }
            25%, 75% { opacity: 0.3; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 10px var(--ui-glow), 0 0 20px var(--ui-glow); }
            50% { box-shadow: 0 0 20px var(--ui-glow), 0 0 40px var(--ui-glow); }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* Header */
        header {
            text-align: center;
            padding: 30px 20px;
            margin-bottom: 30px;
            border: 4px solid var(--genesis-cyan);
            background: linear-gradient(135deg, var(--ui-panel), var(--genesis-dark-blue));
            box-shadow: 0 0 30px var(--ui-glow), inset 0 0 20px rgba(0, 0, 0, 0.5);
            animation: slideIn 0.6s ease-out;
        }

        .main-title {
            font-family: 'Press Start 2P', monospace;
            font-size: clamp(16px, 4vw, 32px);
            color: var(--genesis-yellow);
            text-shadow:
                4px 4px 0 var(--genesis-red),
                6px 6px 0 var(--genesis-orange),
                8px 8px 0 var(--ui-shadow),
                0 0 30px var(--genesis-yellow);
            margin-bottom: 20px;
            line-height: 1.5;
            animation: pulse 3s ease-in-out infinite;
        }

        .subtitle {
            font-size: clamp(10px, 2vw, 14px);
            color: var(--genesis-cyan);
            text-shadow: 0 0 10px var(--genesis-cyan);
            font-family: 'Press Start 2P', monospace;
            margin-top: 15px;
        }

        /* Tab Navigation */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab-btn {
            font-family: 'Press Start 2P', monospace;
            font-size: 10px;
            padding: 15px 25px;
            background: linear-gradient(135deg, var(--genesis-dark-blue), var(--ui-panel));
            color: var(--genesis-cyan);
            border: 3px solid var(--genesis-cyan);
            cursor: pointer;
            transition: all 0.3s ease;
            text-shadow: 0 0 5px var(--genesis-cyan);
            position: relative;
            overflow: hidden;
        }

        .tab-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .tab-btn:hover::before {
            left: 100%;
        }

        .tab-btn:hover {
            background: linear-gradient(135deg, var(--genesis-blue), var(--genesis-dark-blue));
            box-shadow: 0 0 20px var(--ui-glow);
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, var(--genesis-green), var(--genesis-blue));
            border-color: var(--genesis-yellow);
            color: var(--genesis-yellow);
            box-shadow: 0 0 30px rgba(255, 255, 0, 0.6);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: slideIn 0.4s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        /* Input Section */
        .input-section {
            background: linear-gradient(135deg, var(--ui-panel), var(--genesis-dark-blue));
            border: 4px solid var(--genesis-cyan);
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 0 20px var(--ui-glow);
        }

        .input-section h2 {
            font-family: 'Press Start 2P', monospace;
            font-size: 16px;
            color: var(--genesis-yellow);
            margin-bottom: 20px;
            text-shadow: 0 0 10px var(--genesis-yellow);
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            font-family: 'Press Start 2P', monospace;
            font-size: 10px;
            color: var(--genesis-cyan);
            margin-bottom: 10px;
            text-shadow: 0 0 5px var(--genesis-cyan);
        }

        .input-group input[type="text"],
        .input-group input[type="number"],
        .input-group textarea,
        .input-group select {
            width: 100%;
            padding: 15px;
            background: var(--genesis-black);
            border: 3px solid var(--genesis-cyan);
            color: var(--genesis-green);
            font-family: 'Inter', monospace;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .input-group input[type="file"] {
            width: 100%;
            padding: 15px;
            background: var(--genesis-black);
            border: 3px solid var(--genesis-purple);
            color: var(--genesis-pink);
            font-family: 'Press Start 2P', monospace;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .input-group input[type="file"]:hover {
            border-color: var(--genesis-yellow);
            box-shadow: 0 0 20px rgba(255, 255, 0, 0.4);
        }

        .input-group input:focus,
        .input-group textarea:focus,
        .input-group select:focus {
            outline: none;
            border-color: var(--genesis-yellow);
            box-shadow: 0 0 20px rgba(255, 255, 0, 0.4);
        }

        .input-group textarea {
            min-height: 300px;
            font-family: 'Courier New', monospace;
            resize: vertical;
        }

        /* Buttons */
        .btn {
            font-family: 'Press Start 2P', monospace;
            font-size: 12px;
            padding: 15px 30px;
            background: linear-gradient(135deg, var(--genesis-green), var(--genesis-blue));
            color: var(--genesis-white);
            border: 3px solid var(--genesis-cyan);
            cursor: pointer;
            transition: all 0.3s ease;
            text-shadow: 2px 2px 0 var(--genesis-black);
            margin: 5px;
            display: inline-block;
        }

        .btn:hover {
            background: linear-gradient(135deg, var(--genesis-yellow), var(--genesis-orange));
            box-shadow: 0 0 30px rgba(255, 255, 0, 0.6);
            transform: translateY(-3px);
            color: var(--genesis-black);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--genesis-purple), var(--genesis-pink));
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--genesis-red), var(--genesis-orange));
        }

        /* Preview Section */
        .preview-section {
            background: var(--genesis-black);
            border: 4px solid var(--genesis-green);
            padding: 30px;
            margin-top: 20px;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
            max-height: 600px;
            overflow-y: auto;
        }

        .preview-section::-webkit-scrollbar {
            width: 12px;
        }

        .preview-section::-webkit-scrollbar-track {
            background: var(--genesis-black);
            border: 2px solid var(--genesis-cyan);
        }

        .preview-section::-webkit-scrollbar-thumb {
            background: var(--genesis-cyan);
            border: 2px solid var(--genesis-black);
        }

        .preview-section::-webkit-scrollbar-thumb:hover {
            background: var(--genesis-yellow);
        }

        .preview-section h3 {
            font-family: 'Press Start 2P', monospace;
            font-size: 14px;
            color: var(--genesis-cyan);
            margin-bottom: 20px;
            text-shadow: 0 0 10px var(--genesis-cyan);
        }

        /* Parsed Content Display */
        .module-preview {
            color: var(--genesis-white);
        }

        .module-preview h4 {
            font-family: 'Press Start 2P', monospace;
            font-size: 12px;
            color: var(--genesis-yellow);
            margin: 20px 0 10px 0;
            text-shadow: 0 0 8px var(--genesis-yellow);
        }

        .module-preview p {
            line-height: 1.6;
            margin-bottom: 10px;
            color: var(--genesis-cyan);
        }

        .module-preview .section {
            background: var(--ui-panel);
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid var(--genesis-cyan);
        }

        .module-preview .formula {
            background: var(--genesis-black);
            padding: 10px;
            margin: 10px 0;
            border: 2px solid var(--genesis-green);
            font-family: 'Courier New', monospace;
            color: var(--genesis-green);
            text-align: center;
        }

        /* Quiz Preview */
        .quiz-question {
            background: linear-gradient(135deg, var(--ui-panel), var(--genesis-dark-blue));
            padding: 20px;
            margin: 15px 0;
            border: 3px solid var(--genesis-cyan);
            box-shadow: 0 0 15px var(--ui-glow);
        }

        .quiz-question .question-text {
            font-family: 'Press Start 2P', monospace;
            font-size: 10px;
            color: var(--genesis-yellow);
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .quiz-question .answer-option {
            padding: 10px 15px;
            margin: 8px 0;
            background: var(--genesis-black);
            border: 2px solid var(--genesis-cyan);
            color: var(--genesis-cyan);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-question .answer-option:hover {
            background: var(--genesis-dark-blue);
            border-color: var(--genesis-yellow);
            box-shadow: 0 0 15px rgba(255, 255, 0, 0.4);
        }

        .quiz-question .answer-option.correct {
            border-color: var(--genesis-green);
            color: var(--genesis-green);
        }

        /* Stats Panel */
        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--genesis-dark-blue), var(--ui-panel));
            border: 3px solid var(--genesis-cyan);
            padding: 20px;
            text-align: center;
            box-shadow: 0 0 15px var(--ui-glow);
        }

        .stat-value {
            font-family: 'Press Start 2P', monospace;
            font-size: 24px;
            color: var(--genesis-yellow);
            text-shadow: 0 0 10px var(--genesis-yellow);
            margin-bottom: 10px;
        }

        .stat-label {
            font-family: 'Press Start 2P', monospace;
            font-size: 8px;
            color: var(--genesis-cyan);
            text-shadow: 0 0 5px var(--genesis-cyan);
        }

        /* Loading Animation */
        .loading {
            text-align: center;
            padding: 40px;
        }

        .loading-text {
            font-family: 'Press Start 2P', monospace;
            font-size: 14px;
            color: var(--genesis-cyan);
            animation: blink 1s infinite;
        }

        /* Settings Grid */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        /* Template Examples */
        .template-card {
            background: linear-gradient(135deg, var(--ui-panel), var(--genesis-dark-blue));
            border: 3px solid var(--genesis-purple);
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .template-card:hover {
            border-color: var(--genesis-yellow);
            box-shadow: 0 0 25px rgba(255, 255, 0, 0.5);
            transform: translateY(-5px);
        }

        .template-card h4 {
            font-family: 'Press Start 2P', monospace;
            font-size: 10px;
            color: var(--genesis-yellow);
            margin-bottom: 15px;
        }

        .template-card p {
            font-size: 12px;
            color: var(--genesis-cyan);
            line-height: 1.4;
        }

        /* Export Panel */
        .export-panel {
            background: linear-gradient(135deg, var(--genesis-green), var(--genesis-blue));
            border: 4px solid var(--genesis-yellow);
            padding: 30px;
            margin-top: 20px;
            box-shadow: 0 0 30px rgba(255, 255, 0, 0.6);
            animation: glow 2s ease-in-out infinite;
        }

        .export-panel h3 {
            font-family: 'Press Start 2P', monospace;
            font-size: 14px;
            color: var(--genesis-yellow);
            margin-bottom: 20px;
            text-shadow: 2px 2px 0 var(--genesis-black);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-title {
                font-size: 14px;
            }

            .subtitle {
                font-size: 8px;
            }

            .tab-btn {
                font-size: 8px;
                padding: 10px 15px;
            }

            .settings-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Info Box */
        .info-box {
            background: linear-gradient(135deg, var(--genesis-purple), var(--genesis-pink));
            border: 3px solid var(--genesis-yellow);
            padding: 20px;
            margin: 20px 0;
            border-radius: 0;
        }

        .info-box h4 {
            font-family: 'Press Start 2P', monospace;
            font-size: 10px;
            color: var(--genesis-yellow);
            margin-bottom: 15px;
        }

        .info-box ul {
            list-style: none;
            padding-left: 0;
        }

        .info-box li {
            padding: 5px 0;
            color: var(--genesis-white);
            font-size: 12px;
        }

        .info-box li::before {
            content: '‚ñ∂ ';
            color: var(--genesis-yellow);
            font-family: 'Press Start 2P', monospace;
            margin-right: 10px;
        }

        .upload-status {
            margin-top: 10px;
            padding: 10px;
            background: var(--genesis-black);
            border: 2px solid var(--genesis-green);
            color: var(--genesis-green);
            font-family: 'Press Start 2P', monospace;
            font-size: 8px;
            display: none;
        }

        .upload-status.show {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 class="main-title">NEETS INTERACTIVE CONVERTER</h1>
            <p class="subtitle">‚ö° TRANSFORM TRAINING CONTENT INTO RETRO GAMING EXPERIENCES ‚ö°</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" data-tab="input">üìù INPUT</button>
            <button class="tab-btn" data-tab="preview">üëÅÔ∏è PREVIEW</button>
            <button class="tab-btn" data-tab="quiz">üéÆ QUIZ GEN</button>
            <button class="tab-btn" data-tab="settings">‚öôÔ∏è SETTINGS</button>
            <button class="tab-btn" data-tab="export">üíæ EXPORT</button>
            <button class="tab-btn" data-tab="templates">üìö TEMPLATES</button>
        </div>

        <!-- INPUT TAB -->
        <div id="input" class="tab-content active">
            <div class="input-section">
                <h2>üìÑ ENTER NEETS CONTENT</h2>

                <div class="info-box">
                    <h4>SUPPORTED FORMAT:</h4>
                    <ul>
                        <li>Upload PDF files (automatic text extraction)</li>
                        <li>Paste text from NEETS modules, textbooks, or training materials</li>
                        <li>Use Markdown-style headers (# Title, ## Section, ### Subsection)</li>
                        <li>Include formulas in LaTeX format: $$E = mc^2$$</li>
                        <li>Mark definitions with **term**: description</li>
                        <li>Auto-detects sections, concepts, and quiz content</li>
                    </ul>
                </div>

                <div class="input-group">
                    <label>üìé UPLOAD PDF FILE:</label>
                    <input type="file" id="pdfFile" accept=".pdf" onchange="handlePDFUpload(event)">
                    <div id="uploadStatus" class="upload-status"></div>
                </div>

                <div style="text-align: center; margin: 20px 0;">
                    <p style="color: var(--genesis-yellow); font-family: 'Press Start 2P', monospace; font-size: 12px;">
                        - OR -
                    </p>
                </div>

                <div class="input-group">
                    <label>MODULE TITLE:</label>
                    <input type="text" id="moduleTitle" placeholder="e.g., Introduction to Electron Theory">
                </div>

                <div class="input-group">
                    <label>MODULE NUMBER (optional):</label>
                    <input type="text" id="moduleNumber" placeholder="e.g., Module 1">
                </div>

                <div class="input-group">
                    <label>CONTENT TYPE:</label>
                    <select id="contentType">
                        <option value="electronics">Electronics & Electrical</option>
                        <option value="avionics">Avionics Systems</option>
                        <option value="mathematics">Mathematics & Physics</option>
                        <option value="mechanical">Mechanical Systems</option>
                        <option value="safety">Safety & Procedures</option>
                        <option value="general">General Technical Training</option>
                    </select>
                </div>

                <div class="input-group">
                    <label>PASTE CONTENT HERE:</label>
                    <textarea id="contentInput" placeholder="Paste your NEETS module content here...

Example:
# Introduction to Electron Theory

## What is an Electron?
An electron is a subatomic particle with a negative electric charge. Electrons orbit the nucleus of an atom.

**Charge**: The property of matter that causes it to experience a force in an electromagnetic field.

### Key Properties
- Mass: 9.109 √ó 10^-31 kg
- Charge: -1.602 √ó 10^-19 coulombs

## Ohm's Law
The relationship between voltage, current, and resistance:

$$V = I √ó R$$

Where:
- V = Voltage (volts)
- I = Current (amperes)
- R = Resistance (ohms)

### Practice Problem
If a circuit has a resistance of 10 ohms and a current of 2 amperes, what is the voltage?

Answer: V = 2 √ó 10 = 20 volts
"></textarea>
                </div>

                <button class="btn" onclick="parseContent()">‚ö° PARSE CONTENT</button>
                <button class="btn btn-secondary" onclick="clearInput()">üóëÔ∏è CLEAR</button>
            </div>
        </div>

        <!-- PREVIEW TAB -->
        <div id="preview" class="tab-content">
            <div class="stats-panel">
                <div class="stat-card">
                    <div class="stat-value" id="sectionCount">0</div>
                    <div class="stat-label">SECTIONS</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="conceptCount">0</div>
                    <div class="stat-label">CONCEPTS</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="formulaCount">0</div>
                    <div class="stat-label">FORMULAS</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="quizCount">0</div>
                    <div class="stat-label">QUIZ QUESTIONS</div>
                </div>
            </div>

            <div class="preview-section">
                <h3>üìñ MODULE PREVIEW</h3>
                <div id="modulePreview" class="module-preview">
                    <p style="text-align: center; color: var(--genesis-gray); padding: 40px;">
                        Parse content first to see preview...
                    </p>
                </div>
            </div>
        </div>

        <!-- QUIZ TAB -->
        <div id="quiz" class="tab-content">
            <div class="input-section">
                <h2>üéÆ AUTO-GENERATED QUIZ</h2>
                <p style="color: var(--genesis-cyan); margin-bottom: 20px; line-height: 1.6;">
                    Quiz questions are automatically generated from your content using intelligent analysis.
                    Questions test comprehension, formulas, definitions, and problem-solving skills.
                </p>

                <div class="settings-grid">
                    <div class="input-group">
                        <label>QUESTIONS PER SECTION:</label>
                        <select id="questionsPerSection">
                            <option value="3">3 Questions</option>
                            <option value="5" selected>5 Questions</option>
                            <option value="10">10 Questions</option>
                            <option value="15">15 Questions</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>DIFFICULTY LEVEL:</label>
                        <select id="difficultyLevel">
                            <option value="beginner">Beginner</option>
                            <option value="intermediate" selected>Intermediate</option>
                            <option value="advanced">Advanced</option>
                            <option value="mixed">Mixed</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>QUESTION TYPES:</label>
                        <select id="questionTypes" multiple size="4">
                            <option value="multiple" selected>Multiple Choice</option>
                            <option value="truefalse" selected>True/False</option>
                            <option value="calculation" selected>Calculations</option>
                            <option value="definition">Definitions</option>
                        </select>
                    </div>
                </div>

                <button class="btn" onclick="generateQuiz()">‚ö° GENERATE QUIZ</button>
                <button class="btn btn-secondary" onclick="regenerateQuiz()">üîÑ REGENERATE</button>
            </div>

            <div class="preview-section">
                <h3>üìù QUIZ PREVIEW</h3>
                <div id="quizPreview">
                    <p style="text-align: center; color: var(--genesis-gray); padding: 40px;">
                        Generate quiz to see questions...
                    </p>
                </div>
            </div>
        </div>

        <!-- SETTINGS TAB -->
        <div id="settings" class="tab-content">
            <div class="input-section">
                <h2>‚öôÔ∏è CUSTOMIZATION SETTINGS</h2>

                <div class="settings-grid">
                    <div class="input-group">
                        <label>PRIMARY COLOR:</label>
                        <select id="primaryColor">
                            <option value="cyan" selected>Cyan</option>
                            <option value="yellow">Yellow</option>
                            <option value="green">Green</option>
                            <option value="pink">Pink</option>
                            <option value="orange">Orange</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>ACCENT COLOR:</label>
                        <select id="accentColor">
                            <option value="yellow" selected>Yellow</option>
                            <option value="cyan">Cyan</option>
                            <option value="pink">Pink</option>
                            <option value="orange">Orange</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>ENABLE SCANLINES:</label>
                        <select id="enableScanlines">
                            <option value="yes" selected>Yes</option>
                            <option value="no">No</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>ENABLE SOUND FX:</label>
                        <select id="enableSound">
                            <option value="yes" selected>Yes</option>
                            <option value="no">No</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>INCLUDE PROGRESS TRACKING:</label>
                        <select id="includeProgress">
                            <option value="yes" selected>Yes - Integrate with gamification</option>
                            <option value="no">No - Standalone mode</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>NAVIGATION STYLE:</label>
                        <select id="navStyle">
                            <option value="tabs" selected>Tabs</option>
                            <option value="sidebar">Sidebar</option>
                            <option value="book">Book Pages</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>SIMULATION MODE:</label>
                        <select id="simMode">
                            <option value="auto" selected>Auto-detect from content</option>
                            <option value="calculator">Interactive Calculator</option>
                            <option value="circuit">Circuit Builder</option>
                            <option value="oscilloscope">Oscilloscope</option>
                            <option value="none">None</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>XP REWARD (per completion):</label>
                        <input type="number" id="xpReward" value="30" min="10" max="100">
                    </div>
                </div>

                <button class="btn" onclick="saveSettings()">üíæ SAVE SETTINGS</button>
                <button class="btn btn-secondary" onclick="resetSettings()">üîÑ RESET TO DEFAULT</button>
            </div>
        </div>

        <!-- EXPORT TAB -->
        <div id="export" class="tab-content">
            <div class="export-panel">
                <h3>üíæ READY TO EXPORT</h3>
                <p style="color: var(--genesis-yellow); margin-bottom: 20px; font-size: 12px;">
                    Generate a standalone HTML file with all content, quizzes, simulations, and Sega Genesis styling!
                </p>

                <button class="btn" onclick="exportModule()">‚¨áÔ∏è DOWNLOAD HTML</button>
                <button class="btn btn-secondary" onclick="copyToClipboard()">üìã COPY HTML</button>
                <button class="btn btn-secondary" onclick="previewFullscreen()">üîç PREVIEW FULLSCREEN</button>
            </div>

            <div class="input-section">
                <h2>üìä MODULE STATISTICS</h2>
                <div id="exportStats">
                    <p style="color: var(--genesis-cyan);">Parse content and generate quiz to see statistics...</p>
                </div>
            </div>

            <div class="preview-section">
                <h3>üìÑ GENERATED HTML PREVIEW</h3>
                <div id="htmlPreview" style="font-family: 'Courier New', monospace; font-size: 11px; color: var(--genesis-green);">
                    <p style="text-align: center; color: var(--genesis-gray); padding: 40px;">
                        HTML code will appear here after export...
                    </p>
                </div>
            </div>
        </div>

        <!-- TEMPLATES TAB -->
        <div id="templates" class="tab-content">
            <div class="input-section">
                <h2>üìö EXAMPLE TEMPLATES</h2>
                <p style="color: var(--genesis-cyan); margin-bottom: 20px; line-height: 1.6;">
                    Click any template to load sample NEETS content. Use these as starting points or examples of formatting.
                </p>

                <div class="settings-grid">
                    <div class="template-card" onclick="loadTemplate('electron')">
                        <h4>‚ö° ELECTRON THEORY</h4>
                        <p>Introduction to electrons, atomic structure, and basic electrical principles. Includes formulas and practice problems.</p>
                    </div>

                    <div class="template-card" onclick="loadTemplate('ohms')">
                        <h4>üîå OHM'S LAW</h4>
                        <p>Comprehensive coverage of voltage, current, resistance relationships with calculations and circuit examples.</p>
                    </div>

                    <div class="template-card" onclick="loadTemplate('ac')">
                        <h4>„Ä∞Ô∏è AC CIRCUITS</h4>
                        <p>Alternating current theory, sine waves, frequency, and phase relationships with practical applications.</p>
                    </div>

                    <div class="template-card" onclick="loadTemplate('transistor')">
                        <h4>üî∫ TRANSISTORS</h4>
                        <p>Semiconductor theory, transistor operation, biasing, and amplification with detailed diagrams and calculations.</p>
                    </div>

                    <div class="template-card" onclick="loadTemplate('digital')">
                        <h4>üíæ DIGITAL LOGIC</h4>
                        <p>Boolean algebra, logic gates, truth tables, and basic digital circuits. Perfect for avionics training.</p>
                    </div>

                    <div class="template-card" onclick="loadTemplate('power')">
                        <h4>‚ö° POWER SYSTEMS</h4>
                        <p>Electrical power generation, distribution, transformers, and three-phase systems for aircraft applications.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize PDF.js worker
        if (typeof pdfjsLib !== 'undefined') {
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        }

        // Global state
        let parsedData = {
            title: '',
            number: '',
            contentType: '',
            sections: [],
            concepts: [],
            formulas: [],
            problems: []
        };

        let generatedQuiz = [];
        let settings = {
            primaryColor: 'cyan',
            accentColor: 'yellow',
            enableScanlines: true,
            enableSound: true,
            includeProgress: true,
            navStyle: 'tabs',
            simMode: 'auto',
            xpReward: 30,
            questionsPerSection: 5,
            difficultyLevel: 'intermediate',
            questionTypes: ['multiple', 'truefalse', 'calculation']
        };

        // Initialize app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('NEETS Converter initialized');

            // Setup tab switching
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabName = this.dataset.tab;

                    // Update buttons
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');

                    // Update content
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    document.getElementById(tabName).classList.add('active');
                });
            });

            // Load saved settings
            const saved = localStorage.getItem('neetsConverterSettings');
            if (saved) {
                try {
                    settings = JSON.parse(saved);
                    // Apply saved settings to form
                    Object.keys(settings).forEach(key => {
                        const element = document.getElementById(key);
                        if (element) {
                            if (element.type === 'checkbox') {
                                element.checked = settings[key];
                            } else {
                                element.value = settings[key];
                            }
                        }
                    });
                } catch (e) {
                    console.error('Error loading settings:', e);
                }
            }
        });

        // Handle PDF upload
        async function handlePDFUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const statusDiv = document.getElementById('uploadStatus');
            statusDiv.classList.add('show');
            statusDiv.textContent = 'üìÑ Loading PDF...';

            try {
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await pdfjsLib.getDocument({data: arrayBuffer}).promise;

                statusDiv.textContent = `üìÑ Extracting text from ${pdf.numPages} pages...`;

                let fullText = '';
                for (let i = 1; i <= pdf.numPages; i++) {
                    const page = await pdf.getPage(i);
                    const textContent = await page.getTextContent();
                    const pageText = textContent.items.map(item => item.str).join(' ');
                    fullText += pageText + '\n\n';
                }

                // Clean up text
                fullText = fullText.replace(/\s+/g, ' ').trim();

                // Set extracted text to textarea
                document.getElementById('contentInput').value = fullText;

                // Try to extract title from first line
                const firstLine = fullText.split('\n')[0].trim();
                if (firstLine && !document.getElementById('moduleTitle').value) {
                    document.getElementById('moduleTitle').value = firstLine.substring(0, 100);
                }

                statusDiv.textContent = `‚úÖ Extracted ${fullText.length} characters from ${file.name}`;
                statusDiv.style.borderColor = 'var(--genesis-green)';

                setTimeout(() => {
                    statusDiv.classList.remove('show');
                }, 5000);

            } catch (error) {
                console.error('PDF extraction error:', error);
                statusDiv.textContent = '‚ùå Error reading PDF: ' + error.message;
                statusDiv.style.borderColor = 'var(--genesis-red)';
                statusDiv.style.color = 'var(--genesis-red)';
            }
        }

        // Parse content function
        function parseContent() {
            const title = document.getElementById('moduleTitle').value || 'Untitled Module';
            const number = document.getElementById('moduleNumber').value;
            const contentType = document.getElementById('contentType').value;
            const content = document.getElementById('contentInput').value;

            if (!content.trim()) {
                alert('‚ö†Ô∏è Please enter content to parse!');
                return;
            }

            // Reset parsed data
            parsedData = {
                title: title,
                number: number,
                contentType: contentType,
                sections: [],
                concepts: [],
                formulas: [],
                problems: []
            };

            // Parse content
            const lines = content.split('\n');
            let currentSection = null;
            let currentContent = '';

            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();

                // Main heading (# Title)
                if (line.startsWith('# ')) {
                    if (currentSection) {
                        currentSection.content = currentContent.trim();
                        parsedData.sections.push(currentSection);
                    }
                    currentSection = {
                        level: 1,
                        title: line.substring(2),
                        content: '',
                        subsections: []
                    };
                    currentContent = '';
                }
                // Section heading (## Section)
                else if (line.startsWith('## ')) {
                    if (currentSection && currentContent) {
                        currentSection.content += currentContent.trim() + '\n\n';
                        currentContent = '';
                    }
                    if (!currentSection) {
                        currentSection = { level: 1, title: 'Introduction', content: '', subsections: [] };
                    }
                    currentSection.subsections.push({
                        level: 2,
                        title: line.substring(3),
                        content: ''
                    });
                }
                // Subsection (### Subsection)
                else if (line.startsWith('### ')) {
                    if (currentSection && currentContent) {
                        if (currentSection.subsections.length > 0) {
                            currentSection.subsections[currentSection.subsections.length - 1].content += currentContent.trim() + '\n\n';
                        } else {
                            currentSection.content += currentContent.trim() + '\n\n';
                        }
                        currentContent = '';
                    }
                    if (!currentSection) {
                        currentSection = { level: 1, title: 'Introduction', content: '', subsections: [] };
                    }
                    currentSection.subsections.push({
                        level: 3,
                        title: line.substring(4),
                        content: ''
                    });
                }
                // Formula ($$...$$ or starts with equation keywords)
                else if (line.includes('$$') || /^[A-Z]\s*=/.test(line)) {
                    const formula = line.replace(/\$\$/g, '');
                    parsedData.formulas.push({
                        formula: formula,
                        section: currentSection ? currentSection.title : 'General'
                    });
                    currentContent += line + '\n';
                }
                // Definition (**term**: description)
                else if (line.includes('**') && line.includes(':')) {
                    const match = line.match(/\*\*(.+?)\*\*:\s*(.+)/);
                    if (match) {
                        parsedData.concepts.push({
                            term: match[1],
                            definition: match[2],
                            section: currentSection ? currentSection.title : 'General'
                        });
                    }
                    currentContent += line + '\n';
                }
                // Practice problem
                else if (line.toLowerCase().includes('practice') || line.toLowerCase().includes('problem') || line.toLowerCase().includes('example')) {
                    let problemText = line;
                    let j = i + 1;
                    while (j < lines.length && !lines[j].startsWith('#') && lines[j].trim() !== '') {
                        problemText += '\n' + lines[j];
                        j++;
                    }
                    parsedData.problems.push({
                        text: problemText,
                        section: currentSection ? currentSection.title : 'General'
                    });
                    currentContent += problemText + '\n';
                    i = j - 1;
                }
                else {
                    currentContent += line + '\n';
                }
            }

            // Add last section
            if (currentSection) {
                if (currentContent.trim()) {
                    if (currentSection.subsections.length > 0) {
                        currentSection.subsections[currentSection.subsections.length - 1].content += currentContent.trim();
                    } else {
                        currentSection.content += currentContent.trim();
                    }
                }
                parsedData.sections.push(currentSection);
            }

            // Update stats
            document.getElementById('sectionCount').textContent = parsedData.sections.length;
            document.getElementById('conceptCount').textContent = parsedData.concepts.length;
            document.getElementById('formulaCount').textContent = parsedData.formulas.length;
            document.getElementById('quizCount').textContent = '0';

            // Display preview
            displayPreview();

            alert('‚úÖ Content parsed successfully!\n\n' +
                  `Sections: ${parsedData.sections.length}\n` +
                  `Concepts: ${parsedData.concepts.length}\n` +
                  `Formulas: ${parsedData.formulas.length}\n` +
                  `Problems: ${parsedData.problems.length}`);
        }

        // Display preview
        function displayPreview() {
            const preview = document.getElementById('modulePreview');
            let html = `<h4>üìö ${parsedData.title}</h4>`;

            if (parsedData.number) {
                html += `<p style="color: var(--genesis-yellow); font-family: 'Press Start 2P', monospace; font-size: 10px;">${parsedData.number}</p>`;
            }

            parsedData.sections.forEach(section => {
                html += `<div class="section">`;
                html += `<h4>${section.title}</h4>`;
                if (section.content) {
                    html += `<p>${section.content.substring(0, 200)}${section.content.length > 200 ? '...' : ''}</p>`;
                }

                section.subsections.forEach(sub => {
                    html += `<h4 style="font-size: 10px; margin-left: 20px;">‚ñ∂ ${sub.title}</h4>`;
                    if (sub.content) {
                        html += `<p style="margin-left: 20px;">${sub.content.substring(0, 150)}${sub.content.length > 150 ? '...' : ''}</p>`;
                    }
                });

                html += `</div>`;
            });

            if (parsedData.formulas.length > 0) {
                html += `<h4>üìê KEY FORMULAS (${parsedData.formulas.length})</h4>`;
                parsedData.formulas.forEach(f => {
                    html += `<div class="formula">${escapeHtml(f.formula)}</div>`;
                });
            }

            if (parsedData.concepts.length > 0) {
                html += `<h4>üìñ KEY CONCEPTS (${parsedData.concepts.length})</h4>`;
                parsedData.concepts.slice(0, 5).forEach(c => {
                    html += `<div class="section">`;
                    html += `<p><strong style="color: var(--genesis-yellow);">${escapeHtml(c.term)}:</strong> ${escapeHtml(c.definition)}</p>`;
                    html += `</div>`;
                });
                if (parsedData.concepts.length > 5) {
                    html += `<p style="text-align: center; color: var(--genesis-gray);">...and ${parsedData.concepts.length - 5} more</p>`;
                }
            }

            preview.innerHTML = html;
        }

        // Helper function to escape HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Generate quiz
        function generateQuiz() {
            if (parsedData.sections.length === 0) {
                alert('‚ö†Ô∏è Please parse content first!');
                return;
            }

            generatedQuiz = [];
            const questionsPerSection = parseInt(document.getElementById('questionsPerSection').value);
            const difficulty = document.getElementById('difficultyLevel').value;

            // Generate questions from concepts
            parsedData.concepts.forEach((concept, idx) => {
                if (idx < questionsPerSection) {
                    // Multiple choice about definition
                    generatedQuiz.push({
                        type: 'multiple',
                        question: `What is ${concept.term}?`,
                        options: [
                            concept.definition,
                            'A type of electrical component',
                            'A measurement unit',
                            'A circuit configuration'
                        ],
                        correct: 0,
                        section: concept.section
                    });

                    // True/false
                    generatedQuiz.push({
                        type: 'truefalse',
                        question: `True or False: ${concept.term} is defined as "${concept.definition}"`,
                        options: ['True', 'False'],
                        correct: 0,
                        section: concept.section
                    });
                }
            });

            // Generate questions from formulas
            parsedData.formulas.forEach((formula, idx) => {
                if (idx < questionsPerSection) {
                    generatedQuiz.push({
                        type: 'multiple',
                        question: `Which formula is correct?`,
                        options: [
                            formula.formula,
                            formula.formula.replace('=', '‚â†'),
                            'None of the above',
                            'All of the above'
                        ],
                        correct: 0,
                        section: formula.section
                    });
                }
            });

            // Generate general questions from sections
            parsedData.sections.forEach(section => {
                if (section.content) {
                    const sentences = section.content.split('.').filter(s => s.trim().length > 20);
                    if (sentences.length > 0) {
                        const sentence = sentences[0].trim();
                        generatedQuiz.push({
                            type: 'truefalse',
                            question: `True or False: ${sentence}.`,
                            options: ['True', 'False'],
                            correct: 0,
                            section: section.title
                        });
                    }
                }
            });

            // Shuffle quiz
            generatedQuiz.sort(() => Math.random() - 0.5);

            // Update count
            document.getElementById('quizCount').textContent = generatedQuiz.length;

            // Display quiz
            displayQuiz();

            alert(`‚úÖ Generated ${generatedQuiz.length} quiz questions!`);
        }

        // Display quiz
        function displayQuiz() {
            const quizPreview = document.getElementById('quizPreview');
            let html = '';

            generatedQuiz.forEach((q, idx) => {
                html += `<div class="quiz-question">`;
                html += `<div class="question-text">Q${idx + 1}. ${escapeHtml(q.question)}</div>`;
                q.options.forEach((opt, optIdx) => {
                    const correctClass = optIdx === q.correct ? 'correct' : '';
                    html += `<div class="answer-option ${correctClass}">${String.fromCharCode(65 + optIdx)}. ${escapeHtml(opt)}</div>`;
                });
                html += `<p style="color: var(--genesis-gray); font-size: 10px; margin-top: 10px;">Section: ${escapeHtml(q.section)}</p>`;
                html += `</div>`;
            });

            quizPreview.innerHTML = html;
        }

        // Regenerate quiz
        function regenerateQuiz() {
            if (generatedQuiz.length === 0) {
                generateQuiz();
            } else {
                generatedQuiz.sort(() => Math.random() - 0.5);
                displayQuiz();
                alert('‚úÖ Quiz regenerated with new order!');
            }
        }

        // Clear input
        function clearInput() {
            if (confirm('üóëÔ∏è Clear all input content?')) {
                document.getElementById('contentInput').value = '';
                document.getElementById('moduleTitle').value = '';
                document.getElementById('moduleNumber').value = '';
                document.getElementById('pdfFile').value = '';
            }
        }

        // Save settings
        function saveSettings() {
            settings = {
                primaryColor: document.getElementById('primaryColor').value,
                accentColor: document.getElementById('accentColor').value,
                enableScanlines: document.getElementById('enableScanlines').value === 'yes',
                enableSound: document.getElementById('enableSound').value === 'yes',
                includeProgress: document.getElementById('includeProgress').value === 'yes',
                navStyle: document.getElementById('navStyle').value,
                simMode: document.getElementById('simMode').value,
                xpReward: parseInt(document.getElementById('xpReward').value),
                questionsPerSection: parseInt(document.getElementById('questionsPerSection').value),
                difficultyLevel: document.getElementById('difficultyLevel').value,
                questionTypes: Array.from(document.getElementById('questionTypes').selectedOptions).map(o => o.value)
            };
            localStorage.setItem('neetsConverterSettings', JSON.stringify(settings));
            alert('‚úÖ Settings saved!');
        }

        // Reset settings
        function resetSettings() {
            if (confirm('üîÑ Reset all settings to default?')) {
                document.getElementById('primaryColor').value = 'cyan';
                document.getElementById('accentColor').value = 'yellow';
                document.getElementById('enableScanlines').value = 'yes';
                document.getElementById('enableSound').value = 'yes';
                document.getElementById('includeProgress').value = 'yes';
                document.getElementById('navStyle').value = 'tabs';
                document.getElementById('simMode').value = 'auto';
                document.getElementById('xpReward').value = 30;
                saveSettings();
            }
        }

        // Export module
        function exportModule() {
            if (parsedData.sections.length === 0) {
                alert('‚ö†Ô∏è Please parse content first!');
                return;
            }

            // Generate complete HTML module
            const htmlContent = generateCompleteHTML();

            // Create download
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${parsedData.title.replace(/\s+/g, '-').toLowerCase()}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            // Show preview
            document.getElementById('htmlPreview').textContent = htmlContent.substring(0, 5000) + '\n\n... (truncated)';

            // Show stats
            const statsHTML = `
                <div class="stats-panel">
                    <div class="stat-card">
                        <div class="stat-value">${htmlContent.length}</div>
                        <div class="stat-label">CHARACTERS</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${(htmlContent.length / 1024).toFixed(1)}KB</div>
                        <div class="stat-label">FILE SIZE</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${parsedData.sections.length}</div>
                        <div class="stat-label">SECTIONS</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${generatedQuiz.length}</div>
                        <div class="stat-label">QUIZ QUESTIONS</div>
                    </div>
                </div>
            `;
            document.getElementById('exportStats').innerHTML = statsHTML;

            alert('‚úÖ Module exported successfully!\n\nFile downloaded: ' + a.download);
        }

        // Generate complete HTML
        function generateCompleteHTML() {
            return `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${escapeHtml(parsedData.title)}</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        ${getSegaGenesisCSS()}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 class="main-title">${escapeHtml(parsedData.title)}</h1>
            ${parsedData.number ? `<p class="subtitle">${escapeHtml(parsedData.number)}</p>` : ''}
        </header>
        ${generateModuleHTML()}
        ${generateQuizHTML()}
    </div>
    <script>
        ${generateModuleScript()}
    </script>
</body>
</html>`;
        }

        // Get Sega Genesis CSS
        function getSegaGenesisCSS() {
            return `* { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --genesis-black: #000000; --genesis-blue: #0000ff;
            --genesis-cyan: #00ffff; --genesis-green: #00ff00;
            --genesis-yellow: #ffff00; --genesis-orange: #ff8800;
            --genesis-red: #ff0000; --genesis-pink: #ff00ff;
            --ui-bg: #000033; --ui-panel: #000066;
        }
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--ui-bg), #001144);
            color: white; min-height: 100vh; padding: 20px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        header {
            text-align: center; padding: 30px;
            border: 4px solid var(--genesis-cyan);
            background: linear-gradient(135deg, var(--ui-panel), #000088);
            box-shadow: 0 0 30px rgba(0,255,255,0.5);
            margin-bottom: 30px;
        }
        .main-title {
            font-family: 'Press Start 2P', monospace;
            font-size: clamp(16px, 4vw, 32px);
            color: var(--genesis-yellow);
            text-shadow: 4px 4px 0 var(--genesis-red), 0 0 30px var(--genesis-yellow);
            line-height: 1.5;
        }
        .subtitle {
            font-family: 'Press Start 2P', monospace;
            font-size: 12px;
            color: var(--genesis-cyan);
            margin-top: 15px;
        }
        .content-section {
            background: var(--ui-panel);
            border: 3px solid var(--genesis-cyan);
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 0 20px rgba(0,255,255,0.3);
        }
        .content-section h2 {
            font-family: 'Press Start 2P', monospace;
            font-size: 16px;
            color: var(--genesis-yellow);
            margin-bottom: 20px;
        }
        .content-section h3 {
            font-family: 'Press Start 2P', monospace;
            font-size: 12px;
            color: var(--genesis-cyan);
            margin: 15px 0 10px 0;
        }
        .content-section p {
            line-height: 1.6;
            margin-bottom: 15px;
        }
        .quiz-section {
            margin-top: 30px;
        }
        .quiz-question {
            background: linear-gradient(135deg, var(--ui-panel), #000088);
            border: 3px solid var(--genesis-cyan);
            padding: 20px;
            margin: 15px 0;
        }
        .question-text {
            font-family: 'Press Start 2P', monospace;
            font-size: 10px;
            color: var(--genesis-yellow);
            margin-bottom: 15px;
            line-height: 1.6;
        }
        .answer-btn {
            display: block;
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            background: var(--genesis-black);
            border: 2px solid var(--genesis-cyan);
            color: var(--genesis-cyan);
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .answer-btn:hover {
            background: var(--genesis-blue);
            border-color: var(--genesis-yellow);
            color: var(--genesis-yellow);
            box-shadow: 0 0 15px rgba(255,255,0,0.4);
        }
        #quizResults {
            text-align: center;
            padding: 30px;
            margin-top: 20px;
            background: linear-gradient(135deg, var(--genesis-green), var(--genesis-blue));
            border: 4px solid var(--genesis-yellow);
        }
        #quizResults h3 {
            font-family: 'Press Start 2P', monospace;
            font-size: 18px;
            color: var(--genesis-yellow);
            margin-bottom: 15px;
        }
        #quizResults p {
            font-family: 'Press Start 2P', monospace;
            font-size: 14px;
            color: white;
        }`;
        }

        // Generate module HTML
        function generateModuleHTML() {
            let html = '<div class="module-content">';
            parsedData.sections.forEach(section => {
                html += `<section class="content-section">`;
                html += `<h2>${escapeHtml(section.title)}</h2>`;
                html += `<div>${escapeHtml(section.content)}</div>`;
                section.subsections.forEach(sub => {
                    html += `<h3>${escapeHtml(sub.title)}</h3>`;
                    html += `<div>${escapeHtml(sub.content)}</div>`;
                });
                html += `</section>`;
            });
            html += '</div>';
            return html;
        }

        // Generate quiz HTML
        function generateQuizHTML() {
            if (generatedQuiz.length === 0) return '';

            let html = '<div class="quiz-section">';
            html += '<h2 style="font-family: \'Press Start 2P\', monospace; font-size: 20px; color: var(--genesis-cyan); text-align: center; margin: 30px 0;">üéÆ QUIZ TIME!</h2>';
            generatedQuiz.forEach((q, idx) => {
                html += `<div class="quiz-question" id="q${idx}">`;
                html += `<p class="question-text">Q${idx + 1}. ${escapeHtml(q.question)}</p>`;
                q.options.forEach((opt, optIdx) => {
                    html += `<button class="answer-btn" onclick="checkAnswer(${idx}, ${optIdx}, ${q.correct})">${String.fromCharCode(65 + optIdx)}. ${escapeHtml(opt)}</button>`;
                });
                html += '</div>';
            });
            html += '<div id="quizResults" style="display:none;"></div>';
            html += '</div>';
            return html;
        }

        // Generate module script
        function generateModuleScript() {
            const safeTitle = parsedData.title.replace(/'/g, "\\'");
            return `let score = 0;
        let totalQuestions = ${generatedQuiz.length};
        let answered = 0;

        function checkAnswer(questionIdx, selectedIdx, correctIdx) {
            const buttons = document.querySelectorAll('#q' + questionIdx + ' .answer-btn');
            buttons.forEach(btn => btn.disabled = true);

            answered++;
            if (selectedIdx === correctIdx) {
                score++;
                buttons[selectedIdx].style.background = 'var(--genesis-green)';
                buttons[selectedIdx].style.borderColor = 'var(--genesis-green)';
            } else {
                buttons[selectedIdx].style.background = 'var(--genesis-red)';
                buttons[selectedIdx].style.borderColor = 'var(--genesis-red)';
                buttons[correctIdx].style.background = 'var(--genesis-green)';
                buttons[correctIdx].style.borderColor = 'var(--genesis-green)';
            }

            document.getElementById('q' + questionIdx).style.opacity = '0.7';

            if (answered === totalQuestions) {
                const percentage = Math.round((score / totalQuestions) * 100);
                const resultsDiv = document.getElementById('quizResults');
                resultsDiv.style.display = 'block';
                resultsDiv.innerHTML = '<h3>Quiz Complete!</h3><p>Score: ' + score + '/' + totalQuestions + ' (' + percentage + '%)</p>';

                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });

                if (window.parent && window.parent.completeModule) {
                    window.parent.completeModule('${safeTitle}', percentage);
                }
            }
        }

        console.log('NEETS Module Loaded: ${safeTitle}');`;
        }

        // Copy to clipboard
        function copyToClipboard() {
            if (parsedData.sections.length === 0) {
                alert('‚ö†Ô∏è Please parse content first!');
                return;
            }
            const htmlContent = generateCompleteHTML();
            navigator.clipboard.writeText(htmlContent).then(() => {
                alert('üìã HTML copied to clipboard!');
            }).catch(err => {
                alert('‚ùå Failed to copy: ' + err.message);
            });
        }

        // Preview fullscreen
        function previewFullscreen() {
            if (parsedData.sections.length === 0) {
                alert('‚ö†Ô∏è Please parse content first!');
                return;
            }
            const htmlContent = generateCompleteHTML();
            const newWindow = window.open('', '_blank');
            newWindow.document.write(htmlContent);
            newWindow.document.close();
        }

        // Load template function (templates object defined below)
        function loadTemplate(type) {
            const templates = {
                electron: {
                    title: 'Introduction to Electron Theory',
                    number: 'NEETS Module 1',
                    content: `# Introduction to Electron Theory

## What is an Electron?
An electron is a subatomic particle with a negative electric charge. Electrons orbit the nucleus of an atom and are responsible for electrical conductivity in materials.

**Electron**: A negatively charged subatomic particle that orbits the atomic nucleus.

### Key Properties
- Mass: 9.109 √ó 10^-31 kg
- Charge: -1.602 √ó 10^-19 coulombs
- Spin: 1/2 (fermion)

## Atomic Structure
Atoms consist of a nucleus (protons and neutrons) surrounded by electrons in orbital shells. The number of electrons determines the element's chemical properties.

**Valence Electrons**: Electrons in the outermost shell that participate in chemical bonding.

### Energy Levels
Electrons exist in discrete energy levels or shells (K, L, M, N...). Lower shells have less energy and are filled first.

## Electrical Conductivity
Materials conduct electricity when electrons can move freely. Conductors have loosely bound valence electrons, while insulators hold electrons tightly.

### Practice Problem
If copper has 29 protons, how many electrons does a neutral copper atom have?

Answer: A neutral atom has equal protons and electrons, so 29 electrons.`
                },
                ohms: {
                    title: "Ohm's Law and Basic Circuits",
                    number: 'NEETS Module 2',
                    content: `# Ohm's Law

## The Fundamental Relationship
Ohm's Law describes the relationship between voltage, current, and resistance in electrical circuits.

$$V = I √ó R$$

Where:
- V = Voltage (volts)
- I = Current (amperes)
- R = Resistance (ohms)

**Voltage**: The electrical potential difference between two points.
**Current**: The flow of electric charge through a conductor.
**Resistance**: Opposition to current flow.

## Calculating Circuit Values
Use Ohm's Law to find any unknown value when two are known:

$$I = V / R$$
$$R = V / I$$

### Practice Problem 1
A circuit has 12 volts and 3 ohms resistance. Calculate the current.

Answer: I = V/R = 12/3 = 4 amperes

### Practice Problem 2
If current is 2A and resistance is 6Œ©, what is the voltage?

Answer: V = I√óR = 2√ó6 = 12 volts

## Power Calculations
Electrical power is the rate of energy transfer:

$$P = V √ó I$$
$$P = I^2 √ó R$$
$$P = V^2 / R$$

**Power**: Energy transfer rate measured in watts (W).`
                },
                ac: {
                    title: 'Alternating Current Fundamentals',
                    number: 'NEETS Module 3',
                    content: `# Alternating Current (AC)

## What is AC?
Alternating current periodically reverses direction, unlike direct current (DC) which flows in one direction.

**Alternating Current**: Electrical current that reverses direction periodically.
**Frequency**: Number of complete cycles per second, measured in Hertz (Hz).

## Sine Wave Characteristics
AC voltage follows a sinusoidal waveform:

$$v(t) = V_{peak} √ó sin(2œÄft)$$

Where:
- V_peak = Maximum voltage
- f = Frequency (Hz)
- t = Time (seconds)

### Key Parameters
- **Peak Voltage**: Maximum instantaneous voltage
- **Peak-to-Peak**: Total voltage swing (2 √ó peak)
- **RMS Voltage**: Effective voltage = Peak / ‚àö2

## Standard AC Power
- Frequency: 60 Hz (USA), 50 Hz (Europe)
- Household voltage: 120V RMS (USA)
- Industrial: 240V, 480V, or higher

**RMS (Root Mean Square)**: The equivalent DC voltage that produces the same power.

### Practice Problem
If AC peak voltage is 170V, what is the RMS voltage?

Answer: V_RMS = 170 / ‚àö2 = 170 / 1.414 = 120V`
                },
                transistor: {
                    title: 'Transistor Theory and Applications',
                    number: 'NEETS Module 7',
                    content: `# Transistors

## Introduction to Transistors
A transistor is a semiconductor device that can amplify or switch electronic signals. The most common types are BJT (Bipolar Junction Transistor) and FET (Field Effect Transistor).

**Transistor**: A semiconductor device used for amplification and switching.

## BJT Structure
BJTs have three layers: Emitter, Base, and Collector.

**NPN Transistor**: Electron flow from emitter to collector.
**PNP Transistor**: Hole flow from emitter to collector.

### Current Relationships

$$I_E = I_B + I_C$$

Where:
- I_E = Emitter current
- I_B = Base current
- I_C = Collector current

## Current Gain (Œ≤)
The relationship between collector and base current:

$$Œ≤ = I_C / I_B$$

Typical Œ≤ values: 50 to 300

### Practice Problem
If base current is 20¬µA and Œ≤ = 100, calculate collector current.

Answer: I_C = Œ≤ √ó I_B = 100 √ó 20¬µA = 2mA`
                },
                digital: {
                    title: 'Digital Logic Fundamentals',
                    number: 'NEETS Module 13',
                    content: `# Digital Logic

## Binary System
Digital circuits use binary (base-2) numbers with only two states: 0 and 1.

**Binary**: Number system using only 0 and 1.
**Bit**: Single binary digit.
**Byte**: 8 bits.

## Logic Gates
Basic building blocks of digital circuits:

### AND Gate
Output is 1 only when ALL inputs are 1.
$$Y = A ¬∑ B$$

### OR Gate
Output is 1 when ANY input is 1.
$$Y = A + B$$

### NOT Gate
Output is opposite of input.
$$Y = \\overline{A}$$

## Boolean Algebra
Mathematical system for analyzing digital logic:

**De Morgan's Laws**:
$$\\overline{A ¬∑ B} = \\overline{A} + \\overline{B}$$
$$\\overline{A + B} = \\overline{A} ¬∑ \\overline{B}$$

## Truth Tables
Show all possible input/output combinations for logic circuits.

### Practice Problem
Create truth table for Y = A¬∑B + C

Answer:
A B C | Y
0 0 0 | 0
0 0 1 | 1
0 1 0 | 0
etc...`
                },
                power: {
                    title: 'Electrical Power Systems',
                    number: 'NEETS Module 5',
                    content: `# Power Systems

## Power Generation
Electrical power is generated by converting mechanical energy to electrical energy using generators.

**Generator**: Device that converts mechanical energy to electrical energy.
**Alternator**: AC generator.

## Power Transmission
Electrical power is transmitted over long distances at high voltage to reduce losses.

### Power Loss
Transmission line losses:

$$P_{loss} = I^2 √ó R$$

Higher voltage = lower current = less loss

**Transformer**: Device that changes AC voltage levels.

## Three-Phase Power
Industrial and aircraft systems use three-phase AC power:

$$P_{3œÜ} = ‚àö3 √ó V_L √ó I_L √ó cos(Œ∏)$$

Where:
- V_L = Line voltage
- I_L = Line current
- cos(Œ∏) = Power factor

**Power Factor**: Ratio of real power to apparent power.

### Aircraft Power Systems
- 115V AC, 400 Hz (higher frequency = lighter equipment)
- 28V DC for avionics and lighting
- Emergency power from APU or batteries

## Practice Problem
Calculate 3-phase power with V_L=200V, I_L=10A, PF=0.9

Answer: P = ‚àö3 √ó 200 √ó 10 √ó 0.9 = 3,118W`
                }
            };

            const template = templates[type];
            if (template) {
                document.getElementById('moduleTitle').value = template.title;
                document.getElementById('moduleNumber').value = template.number;
                document.getElementById('contentInput').value = template.content;

                // Switch to input tab
                document.querySelector('.tab-btn[data-tab="input"]').click();

                alert(`‚úÖ Template loaded: ${template.title}\n\nClick "PARSE CONTENT" to process!`);
            }
        }
    </script>
</body>
</html>
